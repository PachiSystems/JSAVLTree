/* AVLTree for JavaScript. v2.0.0. (c) 2013, Brian Milton */
(function(b,c){var a=function(d,g,e){if(!d){throw new Error()}if(e.length>2){var f=Array.prototype.slice.call(e,2);return function(){var h=Array.prototype.slice.call(e);Array.prototype.unshift.apply(h,f);return d.apply(g,h)}}else{return function(){return d.apply(g,e)}}};AVLTree=function(d){this._comparator=d||AVLTree.DEFAULT_COMPARATOR};AVLTree.DEFAULT_COMPARATOR=function(e,d){if(String(e)<String(d)){return -1}else{if(String(e)>String(d)){return 1}}return 0};AVLTree.prototype._root=null;AVLTree.prototype._comparator=null;AVLTree.prototype._minNode=null;AVLTree.prototype._maxNode=null;AVLTree.prototype.add=function(e){if(this._root==null){this._root=new AVLTree.Node(e);this._minNode=this._root;this._maxNode=this._root;return true}var d=null;this._traverse(function(f){var g=null;if(this._comparator(f.value,e)>0){g=f._left;if(f._left==null){d=new AVLTree.Node(e,f);f._left=d;if(f==this._minNode){this._minNode=d}}}else{if(this._comparator(f.value,e)<0){g=f._right;if(f._right==null){d=new AVLTree.Node(e,f);f._right=d;if(f==this._maxNode){this._maxNode=d}}}}return g});if(d){this._traverse(function(f){f.count++;return f._parent},d._parent);this._balance(d._parent)}return !!d};AVLTree.prototype.remove=function(d){var e=null;this._traverse(function(f){var g=null;if(this._comparator(f.value,d)>0){g=f._left}else{if(this._comparator(f.value,d)<0){g=f._right}else{e=f.value;this._removeNode(f)}}return g});return e};AVLTree.prototype.clear=function(){this._root=null;this._minNode=null;this._maxNode=null};AVLTree.prototype.contains=function(d){var e=false;this._traverse(function(f){var g=null;if(this._comparator(f.value,d)>0){g=f._left}else{if(this._comparator(f.value,d)<0){g=f._right}else{e=true}}return g});return e};AVLTree.prototype.getCount=function(){return this._root?this._root.count:0};AVLTree.prototype.getNthValue=function(d){if(d<0||d>=this.getCount()){return null}return this._getNthNode(d).value};AVLTree.prototype.getMinimum=function(){return this._getMinNode().value};AVLTree.prototype.getMaximum=function(){return this._getMaxNode().value};AVLTree.prototype.getHeight=function(){return this._root?this._root.height:0};AVLTree.prototype.getValues=function(){var d=[];this.inOrderTraverse(function(e){d.push(e)});return d};AVLTree.prototype.inOrderTraverse=function(i,e){if(!this._root){return}var f;if(e){this._traverse(function(j){var k=null;if(this._comparator(j.value,e)>0){k=j._left;f=j}else{if(this._comparator(j.value,e)<0){k=j._right}else{f=j}}return k})}else{f=this._getMinNode()}var h=f,g=f._left?f._left:f;while(h!=null){if(h._left!=null&&h._left!=g&&h._right!=g){h=h._left}else{if(h._right!=g){if(i(h.value)){return}}var d=h;h=h._right!=null&&h._right!=g?h._right:h._parent;g=d}}};AVLTree.prototype.reverseOrderTraverse=function(i,e){if(!this._root){return}var f;if(e){this._traverse(a(function(j){var k=null;if(this._comparator(j.value,e)>0){k=j._left}else{if(this._comparator(j.value,e)<0){k=j._right;f=j}else{f=j}}return k},this))}else{f=this._getMaxNode()}var h=f,g=f._right?f._right:f;while(h!=null){if(h._right!=null&&h._right!=g&&h._left!=g){h=h._right}else{if(h._left!=g){if(i(h.value)){return}}var d=h;h=h._left!=null&&h._left!=g?h._left:h._parent;g=d}}};AVLTree.prototype.printAVLTree=function(){if(this._root!==null){return this._root._inOrderPrint()}return false};AVLTree.prototype._traverse=function(g,e,d){var f=e?e:this._root;var d=d?d:null;while(f&&f!=d){f=g.call(this,f)}};AVLTree.prototype._balance=function(d){this._traverse(function(e){var f=e._left?e._left.height:0;var g=e._right?e._right.height:0;if(f-g>1){if(e._left._right&&(!e._left._left||e._left._left.height<e._left._right.height)){this._leftRotate(e._left)}this._rightRotate(e)}else{if(g-f>1){if(e._right._left&&(!e._right._right||e._right._right.height<e._right._left.height)){this._rightRotate(e._right)}this._leftRotate(e)}}f=e._left?e._left.height:0;g=e._right?e._right.height:0;e.height=Math.max(f,g)+1;return e._parent},d)};AVLTree.prototype._leftRotate=function(e){if(e.isLeftChild()){e._parent._left=e._right;e._right._parent=e._parent}else{if(e.isRightChild()){e._parent._right=e._right;e._right._parent=e._parent}else{this._root=e._right;this._root._parent=null}}var d=e._right;e._right=e._right._left;if(e._right!=null){e._right._parent=e}d._left=e;e._parent=d;d.count=e.count;e.count-=(d._right?d._right.count:0)+1};AVLTree.prototype._rightRotate=function(e){if(e.isLeftChild()){e._parent._left=e._left;e._left._parent=e._parent}else{if(e.isRightChild()){e._parent._right=e._left;e._left._parent=e._parent}else{this._root=e._left;this._root._parent=null}}var d=e._left;e._left=e._left._right;if(e._left!=null){e._left._parent=e}d._right=e;e._parent=d;d.count=e.count;e.count-=(d._left?d._left.count:0)+1};AVLTree.prototype._removeNode=function(d){if(d._left!=null||d._right!=null){var f=null;var e;if(d._left!=null){r=this._getMaxNode(d._left);this._traverse(function(g){g.count--;return g._parent},e);if(e!=d._left){e._parent._right=e._left;if(e._left){e._left._parent=e._parent}e._left=d._left;e._left._parent=e;f=e._parent}e._parent=d._parent;e._right=d._right;if(e._right){e._right._parent=e}if(d==this._maxNode){this._maxNode=e}e.count=d.count}else{r=this._getMinNode(d._right);this._traverse(function(g){g.count--;return g._parent},e);if(e!=d._right){e._parent._left=e._right;if(e._right){e._right._parent=e._parent}e._right=d._right;e._right._parent=e;f=e._parent}e._parent=d._parent;e._left=d._left;if(e._left){e._left._parent=e}if(d==this._minNode){this._minNode=e}e.count=d.count}if(d.isLeftChild()){d._parent._left=e}else{if(d.isRightChild()){d._parent._right=e}else{this._root=e}}this._balance(f?f:e)}else{this._traverse(function(g){g.count--;return g._parent},d._parent);if(d.isLeftChild()){this.special=1;d._parent._left=null;if(d==this._minNode){this._minNode=d._parent}this._balance(d._parent)}else{if(d.isRightChild()){d._parent._right=null;if(d==this._maxNode){this._maxNode=d._parent}this._balance(d._parent)}else{this.clear()}}}};AVLTree.prototype._getNthNode=function(g,e){var d=e||this._root;var f=d._left?d._left.count:0;if(g<f){return this._getNthNode(g,d._left)}else{if(g==f){return d}else{return this._getNthNode(g-f-1,d._right)}}};AVLTree.prototype._getMinNode=function(d){if(!d){return this._minNode}var e=d;this._traverse(function(f){var g=null;if(f._left){e=f._left;g=f._left}return g},d);return e};AVLTree.prototype._getMaxNode=function(e){if(!e){return this._maxNode}var d=e;this._traverse(function(f){var g=null;if(f._right){d=f._right;g=f._right}return g},e);return d};AVLTree.Node=function(e,d){this.value=e;this._parent=d?d:null;this.count=1};AVLTree.Node.prototype._inOrderPrint=function(d){d=d||"";d="--"+d;if(this._left!==null){this._left._inOrderPrint(d)}console.log(d+this.value);if(this._right!==null){this._right._inOrderPrint(d)}};AVLTree.Node.prototype._left=null;AVLTree.Node.prototype._right=null;AVLTree.Node.prototype.height=1;AVLTree.Node.prototype.isRightChild=function(){return !!this._parent&&this._parent._right==this};AVLTree.Node.prototype.isLeftChild=function(){return !!this._parent&&this._parent._left==this};if(typeof module==="object"&&module&&typeof module.exports==="object"){module.exports=AVLTree}else{b.AVLTree=AVLTree;if(typeof define==="function"&&define.amd){define("avltree",[],function(){return AVLTree})}}})(window);